{% extends "forum_base.html" %}

{% set title = 'Forum' %}
{% set breadcrumb_items = [{'title': 'Forums'}, {'title': forum.name, 'url': forum.get_url()}] %}

{% block forum_content %}
    {%- if forum_menu_current != 'latest' %}
    <div class="row">
        <div class="small-12 columns">
            <h2 class="left">{{ board.name }}</h2>
            {%- if board.description %}
            <p class="left">{{ board.description }}</p>
            {%- endif %}
            {%- if current_user.is_authenticated() %}
            <a class="button tiny right" type="submit" href="{{ board.get_post_url() }}">Post New Topic</a>
            {%- endif %}
        </div>
    </div>
    {%- endif %}
    <table class="topic-table">
        <thead>
            <tr>
                <th>Topic</th>
                <th width="200px">Latest</th>
            </tr>
        </thead>
        <tbody>
            {% for topic in topics %}
                <tr>
                    <td>
                        <a class="topic-title" href="{{ topic.get_url() }}">{{ topic.title }}</a>
                        <span class="topic-by"><a class="player-name" href="{{ topic.author.get_profile_url() }}">{{ topic.author.name }}</a> <span>{{ topic.date|full_date|safe }}</span></span>
                    </td>
                    <td>
                        <div class="latest-container">
                            {% set latest_post = topic.get_last_post() %}
                            <img src="{{ latest_post.author.get_avatar_url() }}">
                            <div class="post-info">
                                <a class="post-user player-name" href="{{ latest_post.author.get_profile_url() }}">{{ latest_post.author.name }}</a>
                                <a class="post-date" href="{{ latest_post.get_post_url() }}">{{ latest_post.date|full_date|safe }}</a>
                            </div>
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
